<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script>
document.addEventListener("play", function(evt) {
    if(this.$AudioPlaying && this.$AudioPlaying !== evt.target) {
        this.$AudioPlaying.pause();
    }
    this.$AudioPlaying = evt.target;
}, true);
</script>
<script>
$(document).ready(function() {
  $('#gain_od').on('change', function() {
    change($(this).val(), "audio_cegod");
  });
});
$(document).ready(function() {
  $('#gain_hc').on('change', function() {
    change($(this).val(), "audio_ceghc");
  });
});

$(document).ready(function() {
  $('#inp_sdr').on('change', function() {
    change($(this).val(), "audio_st");
  });
});

function change(gain, classname) {
  var all_audio = document.getElementsByClassName(classname);
  for (var i = all_audio.length - 1; i >= 0; i--)
  {
    var audio = all_audio[i];
    var source = audio.getElementsByTagName("source")[0];
    audio.pause();
    var old_src = source.src;
    source.src = old_src.replace(/[\/]\d\d[\/]/, "/" + gain + "/");
    audio.load();
  }
}
</script>

This website accompanies the paper "Removing Distortion Effects in Music Using Deep Neural Networks" (see abstract below). Here, we provide listening examples of the restored audio excerpts generated by the models described in the paper.

**Please note: This site is still in development. More audio examples and numerical score values for each example will follow soon.**

# Abstract

Audio effects are an essential element in the context of music production, and therefore, modeling analog audio effects has been extensively researched for decades using system-identification methods, circuit simulation, and recently, deep learning. However, only few works tackled the reconstruction of signals that were processed using an audio effect unit. Given the recent advances in music source separation and automatic mixing, the removal of audio effects could facilitate an automatic remixing system.
This paper focuses on removing distortion and clipping applied to guitar tracks for music production while presenting a comparative investigation of different deep neural network (DNN) architectures on this task. We achieve exceptionally good results in distortion removal using DNNs for effects that superimpose the clean signal to the distorted signal, while the task is more challenging if the clean signal is not superimposed. Nevertheless, in the latter case, the neural models under evaluation surpass one state-of-the-art declipping system in terms of source-to-distortion ratio, leading to better quality and faster inference.

# Task A: Electric Guitar

For the first task (removing distortion effects in guitar recordings), we used an internal dataset, which we refer to as CEG (Clean Electric Guitar Effects) dataset. The data was gathered from various sources, mainly commercial audio loop packages and live recordings of solo guitar playing.

## CEG-OD

To create the processed input dataset CEG-OD, the SoX overdrive algorithm was applied to the data using five uniformly sampled gain levels in the range of γ ∈ [20, 50] dB.

### Results

![results_ceg_od](assets/img/lcegfx_overdrive_abs_scores.png)
Box plot of scores for the CEG-OD dataset that was augmented using the overdrive algorithm. The boxes show the first and third quartile of the data while the median is indicated with a line in the box. Higher score indicates superior performance except for FAD. Demucs can be regarded as the best model for all metrics. The results indicate that time-domain-based models are better suited to solve the task of overdrive removal.

### Audio Examples

<label for="gain_od">Select gain:</label>
<select name="gain_od" id="gain_od">
  <option value="20">20 dB</option>
  <option value="25">25 dB</option>
  <option value="30">30 dB</option>
  <option value="35" selected="selected">35 dB</option>
  <option value="40">40 dB</option>
  <option value="45">45 dB</option>
  <option value="50">50 dB</option>
</select>

<table style='text-align: center;'>
  <tbody>
    <tr>
      <td>Example</td>
      <td>Distorted</td>
      <td>Target</td>
      <td>Demucs</td>
      <td>Wave-U-Net</td>
      <td>CRAFx</td>
      <td>UMX</td>
      <td>IRM</td>
    </tr>
    <tr>
      <td>A</td>
      <td><audio class="audio_cegod" controls="" style="width: 100px;"><source src="./assets/audio/CEG_OD/pow2/35/inp.wav" type="audio/mpeg" /></audio></td>
      <td><audio class="audio_cegod" controls="" style="width: 100px;"><source src="./assets/audio/CEG_OD/pow2/35/tar.wav" type="audio/mpeg" /></audio></td>
      <td><audio class="audio_cegod" controls="" style="width: 100px;"><source src="./assets/audio/CEG_OD/pow2/35/demucs.wav" type="audio/mpeg" /></audio></td>
      <td><audio class="audio_cegod" controls="" style="width: 100px;"><source src="./assets/audio/CEG_OD/pow2/35/waveunet.wav" type="audio/mpeg" /></audio></td>
      <td><audio class="audio_cegod" controls="" style="width: 100px;"><source src="./assets/audio/CEG_OD/pow2/35/crafx.wav" type="audio/mpeg" /></audio></td>
      <td><audio class="audio_cegod" controls="" style="width: 100px;"><source src="./assets/audio/CEG_OD/pow2/35/umx.wav" type="audio/mpeg" /></audio></td>
      <td><audio class="audio_cegod" controls="" style="width: 100px;"><source src="./assets/audio/CEG_OD/pow2/35/irm.wav" type="audio/mpeg" /></audio></td>
    </tr>
    <tr>
      <td>B</td>
      <td><audio class="audio_cegod" controls="" style="width: 100px;"><source src="./assets/audio/CEG_OD/mel1/35/inp.wav" type="audio/mpeg" /></audio></td>
      <td><audio class="audio_cegod" controls="" style="width: 100px;"><source src="./assets/audio/CEG_OD/mel1/35/tar.wav" type="audio/mpeg" /></audio></td>
      <td><audio class="audio_cegod" controls="" style="width: 100px;"><source src="./assets/audio/CEG_OD/mel1/35/demucs.wav" type="audio/mpeg" /></audio></td>
      <td><audio class="audio_cegod" controls="" style="width: 100px;"><source src="./assets/audio/CEG_OD/mel1/35/waveunet.wav" type="audio/mpeg" /></audio></td>
      <td><audio class="audio_cegod" controls="" style="width: 100px;"><source src="./assets/audio/CEG_OD/mel1/35/crafx.wav" type="audio/mpeg" /></audio></td>
      <td><audio class="audio_cegod" controls="" style="width: 100px;"><source src="./assets/audio/CEG_OD/mel1/35/umx.wav" type="audio/mpeg" /></audio></td>
      <td><audio class="audio_cegod" controls="" style="width: 100px;"><source src="./assets/audio/CEG_OD/mel1/35/irm.wav" type="audio/mpeg" /></audio></td>
    </tr>
    <tr>
      <td>C</td>
      <td><audio class="audio_cegod" controls="" style="width: 100px;"><source src="./assets/audio/CEG_OD/sin1/35/inp.wav" type="audio/mpeg" /></audio></td>
      <td><audio class="audio_cegod" controls="" style="width: 100px;"><source src="./assets/audio/CEG_OD/sin1/35/tar.wav" type="audio/mpeg" /></audio></td>
      <td><audio class="audio_cegod" controls="" style="width: 100px;"><source src="./assets/audio/CEG_OD/sin1/35/demucs.wav" type="audio/mpeg" /></audio></td>
      <td><audio class="audio_cegod" controls="" style="width: 100px;"><source src="./assets/audio/CEG_OD/sin1/35/waveunet.wav" type="audio/mpeg" /></audio></td>
      <td><audio class="audio_cegod" controls="" style="width: 100px;"><source src="./assets/audio/CEG_OD/sin1/35/crafx.wav" type="audio/mpeg" /></audio></td>
      <td><audio class="audio_cegod" controls="" style="width: 100px;"><source src="./assets/audio/CEG_OD/sin1/35/umx.wav" type="audio/mpeg" /></audio></td>
      <td><audio class="audio_cegod" controls="" style="width: 100px;"><source src="./assets/audio/CEG_OD/sin1/35/irm.wav" type="audio/mpeg" /></audio></td>
    </tr>
    <tr>
      <td>D</td>
      <td><audio class="audio_cegod" controls="" style="width: 100px;"><source src="./assets/audio/CEG_OD/pow1/35/inp.wav" type="audio/mpeg" /></audio></td>
      <td><audio class="audio_cegod" controls="" style="width: 100px;"><source src="./assets/audio/CEG_OD/pow1/35/tar.wav" type="audio/mpeg" /></audio></td>
      <td><audio class="audio_cegod" controls="" style="width: 100px;"><source src="./assets/audio/CEG_OD/pow1/35/demucs.wav" type="audio/mpeg" /></audio></td>
      <td><audio class="audio_cegod" controls="" style="width: 100px;"><source src="./assets/audio/CEG_OD/pow1/35/waveunet.wav" type="audio/mpeg" /></audio></td>
      <td><audio class="audio_cegod" controls="" style="width: 100px;"><source src="./assets/audio/CEG_OD/pow1/35/crafx.wav" type="audio/mpeg" /></audio></td>
      <td><audio class="audio_cegod" controls="" style="width: 100px;"><source src="./assets/audio/CEG_OD/pow1/35/umx.wav" type="audio/mpeg" /></audio></td>
      <td><audio class="audio_cegod" controls="" style="width: 100px;"><source src="./assets/audio/CEG_OD/pow1/35/irm.wav" type="audio/mpeg" /></audio></td>
    </tr>
  </tbody>
</table>

All examples were normalized to -19 dB LUFS according to ITU-R BS.1770-4.

## CEG-HC

Similar to the procedure for CEG-OD, the input dataset for the hard-clipping task, CEG-HC, was created using hard-clipping and five uniformly-sampled gain levels in the range of γ ∈ [20, 50] dB, respectively.

### Results

![results_ceg_hc](assets/img/lcegfx_hardclipping_abs_scores.png)
Box plot of scores for the CEG-HC dataset that was augmented using the hard-clipping algorithm. The boxes show the first and third quartile of the data while the median is indicated with a line in the box. Higher score indicates superior performance except for FAD. It is difficult to clearly determine the best model, although Demucs represents a good compromise for all the metrics.

### Audio Examples
<label for="gain_hc">Select gain:</label>
<select name="gain_hc" id="gain_hc">
  <option value="20">20 dB</option>
  <option value="25">25 dB</option>
  <option value="30">30 dB</option>
  <option value="35" selected="selected">35 dB</option>
  <option value="40">40 dB</option>
  <option value="45">45 dB</option>
  <option value="50">50 dB</option>
</select>

<table style='text-align: center;'>
  <tbody>
    <tr>
      <td>Example</td>
      <td>Distorted</td>
      <td>Target</td>
      <td>Demucs</td>
      <td>Wave-U-Net</td>
      <td>CRAFx</td>
      <td>UMX</td>
    </tr>
    <tr>
      <td>A</td>
      <td><audio class="audio_ceghc" controls="" style="width: 100px;"><source src="./assets/audio/CEG_HC/pow2/35/inp.wav" type="audio/mpeg" /></audio></td>
      <td><audio class="audio_ceghc" controls="" style="width: 100px;"><source src="./assets/audio/CEG_HC/pow2/35/tar.wav" type="audio/mpeg" /></audio></td>
      <td><audio class="audio_ceghc" controls="" style="width: 100px;"><source src="./assets/audio/CEG_HC/pow2/35/demucs.wav" type="audio/mpeg" /></audio></td>
      <td><audio class="audio_ceghc" controls="" style="width: 100px;"><source src="./assets/audio/CEG_HC/pow2/35/waveunet.wav" type="audio/mpeg" /></audio></td>
      <td><audio class="audio_ceghc" controls="" style="width: 100px;"><source src="./assets/audio/CEG_HC/pow2/35/crafx.wav" type="audio/mpeg" /></audio></td>
      <td><audio class="audio_ceghc" controls="" style="width: 100px;"><source src="./assets/audio/CEG_HC/pow2/35/umx.wav" type="audio/mpeg" /></audio></td>
    </tr>
    <tr>
      <td>B</td>
      <td><audio class="audio_ceghc" controls="" style="width: 100px;"><source src="./assets/audio/CEG_HC/mel1/35/inp.wav" type="audio/mpeg" /></audio></td>
      <td><audio class="audio_ceghc" controls="" style="width: 100px;"><source src="./assets/audio/CEG_HC/mel1/35/tar.wav" type="audio/mpeg" /></audio></td>
      <td><audio class="audio_ceghc" controls="" style="width: 100px;"><source src="./assets/audio/CEG_HC/mel1/35/demucs.wav" type="audio/mpeg" /></audio></td>
      <td><audio class="audio_ceghc" controls="" style="width: 100px;"><source src="./assets/audio/CEG_HC/mel1/35/waveunet.wav" type="audio/mpeg" /></audio></td>
      <td><audio class="audio_ceghc" controls="" style="width: 100px;"><source src="./assets/audio/CEG_HC/mel1/35/crafx.wav" type="audio/mpeg" /></audio></td>
      <td><audio class="audio_ceghc" controls="" style="width: 100px;"><source src="./assets/audio/CEG_HC/mel1/35/umx.wav" type="audio/mpeg" /></audio></td>
    </tr>
    <tr>
      <td>C</td>
      <td><audio class="audio_ceghc" controls="" style="width: 100px;"><source src="./assets/audio/CEG_HC/sin1/35/inp.wav" type="audio/mpeg" /></audio></td>
      <td><audio class="audio_ceghc" controls="" style="width: 100px;"><source src="./assets/audio/CEG_HC/sin1/35/tar.wav" type="audio/mpeg" /></audio></td>
      <td><audio class="audio_ceghc" controls="" style="width: 100px;"><source src="./assets/audio/CEG_HC/sin1/35/demucs.wav" type="audio/mpeg" /></audio></td>
      <td><audio class="audio_ceghc" controls="" style="width: 100px;"><source src="./assets/audio/CEG_HC/sin1/35/waveunet.wav" type="audio/mpeg" /></audio></td>
      <td><audio class="audio_ceghc" controls="" style="width: 100px;"><source src="./assets/audio/CEG_HC/sin1/35/crafx.wav" type="audio/mpeg" /></audio></td>
      <td><audio class="audio_ceghc" controls="" style="width: 100px;"><source src="./assets/audio/CEG_HC/sin1/35/umx.wav" type="audio/mpeg" /></audio></td>
    </tr>
    <tr>
      <td>D</td>
      <td><audio class="audio_ceghc" controls="" style="width: 100px;"><source src="./assets/audio/CEG_HC/pow1/35/inp.wav" type="audio/mpeg" /></audio></td>
      <td><audio class="audio_ceghc" controls="" style="width: 100px;"><source src="./assets/audio/CEG_HC/pow1/35/tar.wav" type="audio/mpeg" /></audio></td>
      <td><audio class="audio_ceghc" controls="" style="width: 100px;"><source src="./assets/audio/CEG_HC/pow1/35/demucs.wav" type="audio/mpeg" /></audio></td>
      <td><audio class="audio_ceghc" controls="" style="width: 100px;"><source src="./assets/audio/CEG_HC/pow1/35/waveunet.wav" type="audio/mpeg" /></audio></td>
      <td><audio class="audio_ceghc" controls="" style="width: 100px;"><source src="./assets/audio/CEG_HC/pow1/35/crafx.wav" type="audio/mpeg" /></audio></td>
      <td><audio class="audio_ceghc" controls="" style="width: 100px;"><source src="./assets/audio/CEG_HC/pow1/35/umx.wav" type="audio/mpeg" /></audio></td>
    </tr>
  </tbody>
</table>

All examples were normalized to -19 dB LUFS according to ITU-R BS.1770-4.

# Task B: SignalTrain

Although CEG represents a good source of data for our experiments due to its specificity of instrument, it remains a limited resource in terms of size, variety and realism. Before attempting to train a system to handle recordings in real environments (e.g., a commercial song), we need to investigate how the current models at our disposal handle the availability of more and diverse training data. For this purpose, we also performed experiments on the SignalTrain dataset, which consists of more than 24 hours of music and randomly-generated test sounds.

By applying hard-clipping to this clean data, we created SignalTrain-HC. In contrast to CEG-HC and CEG-OD, hard-clipping was applied using a uniformly-sampled input SDR value in the range SDRinp ∈ [1, 20] dB. During the evaluation stage, we applied each input SDR in the set SDRinp ∈ {1,3,5,7,10,15,20} dB to each sample in the test set.

### Results

![results_ceg_hc](assets/img/signaltrain_hardclipping_abs_scores.png)
Box plot of scores for the SignalTrain-HC dataset that was augmented using the hard-clipping algorithm. The boxes show the first and third quartile of the data while the median is indicated with a line in the box. Higher score indicates superior performance except for FAD. Demucs can be regarded as the best model regarding the median score across all metrics.

### Audio Examples


<label for="inp_sdr">Select input SDR:</label>
<select name="inp_sdr" id="inp_sdr">
  <option value="01">1 dB</option>
  <option value="03">3 dB</option>
  <option value="05">5 dB</option>
  <option value="07" selected="selected">7 dB</option>
  <option value="10">10 dB</option>
  <option value="15">15 dB</option>
  <option value="20">20 dB</option>
</select>

<table style='text-align: center;'>
  <tbody>
    <tr>
      <td>Example</td>
      <td>Distorted</td>
      <td>Target</td>
      <td>Demucs</td>
      <td>Wave-U-Net</td>
      <td>UMX</td>
      <td>A-SPADE</td>
      <td>IRM</td>
    </tr>
    <tr>
      <td>A</td>
      <td><audio class="audio_st" controls="" style="width: 100px;"><source src="./assets/audio/ST_HC/pian/07/inp.wav" type="audio/mpeg" /></audio></td>
      <td><audio class="audio_st" controls="" style="width: 100px;"><source src="./assets/audio/ST_HC/pian/07/tar.wav" type="audio/mpeg" /></audio></td>
      <td><audio class="audio_st" controls="" style="width: 100px;"><source src="./assets/audio/ST_HC/pian/07/demucs.wav" type="audio/mpeg" /></audio></td>
      <td><audio class="audio_st" controls="" style="width: 100px;"><source src="./assets/audio/ST_HC/pian/07/waveunet.wav" type="audio/mpeg" /></audio></td>
      <td><audio class="audio_st" controls="" style="width: 100px;"><source src="./assets/audio/ST_HC/pian/07/umx.wav" type="audio/mpeg" /></audio></td>
      <td><audio class="audio_st" controls="" style="width: 100px;"><source src="./assets/audio/ST_HC/pian/07/aspade.wav" type="audio/mpeg" /></audio></td>
      <td><audio class="audio_st" controls="" style="width: 100px;"><source src="./assets/audio/ST_HC/pian/07/irm.wav" type="audio/mpeg" /></audio></td>
    </tr>
    <tr>
      <td>B</td>
      <td><audio class="audio_st" controls="" style="width: 100px;"><source src="./assets/audio/ST_HC/perc/07/inp.wav" type="audio/mpeg" /></audio></td>
      <td><audio class="audio_st" controls="" style="width: 100px;"><source src="./assets/audio/ST_HC/perc/07/tar.wav" type="audio/mpeg" /></audio></td>
      <td><audio class="audio_st" controls="" style="width: 100px;"><source src="./assets/audio/ST_HC/perc/07/demucs.wav" type="audio/mpeg" /></audio></td>
      <td><audio class="audio_st" controls="" style="width: 100px;"><source src="./assets/audio/ST_HC/perc/07/waveunet.wav" type="audio/mpeg" /></audio></td>
      <td><audio class="audio_st" controls="" style="width: 100px;"><source src="./assets/audio/ST_HC/perc/07/umx.wav" type="audio/mpeg" /></audio></td>
      <td><audio class="audio_st" controls="" style="width: 100px;"><source src="./assets/audio/ST_HC/perc/07/aspade.wav" type="audio/mpeg" /></audio></td>
      <td><audio class="audio_st" controls="" style="width: 100px;"><source src="./assets/audio/ST_HC/perc/07/irm.wav" type="audio/mpeg" /></audio></td>
    </tr>
    <tr>
      <td>C</td>
      <td><audio class="audio_st" controls="" style="width: 100px;"><source src="./assets/audio/ST_HC/bass/07/inp.wav" type="audio/mpeg" /></audio></td>
      <td><audio class="audio_st" controls="" style="width: 100px;"><source src="./assets/audio/ST_HC/bass/07/tar.wav" type="audio/mpeg" /></audio></td>
      <td><audio class="audio_st" controls="" style="width: 100px;"><source src="./assets/audio/ST_HC/bass/07/demucs.wav" type="audio/mpeg" /></audio></td>
      <td><audio class="audio_st" controls="" style="width: 100px;"><source src="./assets/audio/ST_HC/bass/07/waveunet.wav" type="audio/mpeg" /></audio></td>
      <td><audio class="audio_st" controls="" style="width: 100px;"><source src="./assets/audio/ST_HC/bass/07/umx.wav" type="audio/mpeg" /></audio></td>
      <td><audio class="audio_st" controls="" style="width: 100px;"><source src="./assets/audio/ST_HC/bass/07/aspade.wav" type="audio/mpeg" /></audio></td>
      <td><audio class="audio_st" controls="" style="width: 100px;"><source src="./assets/audio/ST_HC/bass/07/irm.wav" type="audio/mpeg" /></audio></td>
    </tr>
    <tr>
      <td>D</td>
      <td><audio class="audio_st" controls="" style="width: 100px;"><source src="./assets/audio/ST_HC/song/07/inp.wav" type="audio/mpeg" /></audio></td>
      <td><audio class="audio_st" controls="" style="width: 100px;"><source src="./assets/audio/ST_HC/song/07/tar.wav" type="audio/mpeg" /></audio></td>
      <td><audio class="audio_st" controls="" style="width: 100px;"><source src="./assets/audio/ST_HC/song/07/demucs.wav" type="audio/mpeg" /></audio></td>
      <td><audio class="audio_st" controls="" style="width: 100px;"><source src="./assets/audio/ST_HC/song/07/waveunet.wav" type="audio/mpeg" /></audio></td>
      <td><audio class="audio_st" controls="" style="width: 100px;"><source src="./assets/audio/ST_HC/song/07/umx.wav" type="audio/mpeg" /></audio></td>
      <td><audio class="audio_st" controls="" style="width: 100px;"><source src="./assets/audio/ST_HC/song/07/aspade.wav" type="audio/mpeg" /></audio></td>
      <td><audio class="audio_st" controls="" style="width: 100px;"><source src="./assets/audio/ST_HC/song/07/irm.wav" type="audio/mpeg" /></audio></td>
    </tr>

  </tbody>
</table>
All examples were normalized to -23 dB LUFS according to ITU-R BS.1770-4.

### Dependency on Input SDR

![results_ceg_od](assets/img/signaltrain_hardclipping_drive_vs_scores.png)
Mean scores obtained from the SignalTrain-HC dataset in comparison with the input SDR. The 95 % confidence interval is depicted with a light colored area around each line. Additionally, the black, dashed line depicts the respective score for the distorted input signals. A-SPADE’s performance drops significantly towards heavily clipped signals with a SDRinp of 1 dB; the neural models do not exhibit such a behavior.

# Citation

    @article{imort2022removing,
        title={Removing Distortion Effects in Music Using Deep Neural Networks},
        author={Imort, Johannes and Fabbro, Giorgio and Martínez Ramírez, Marco A. and Uhlich, Stefan and Koyama, Yuichiro and Mitsufuji, Yuki},
        booktitle={arXiv:2202.01664},
        year={2022}}
